\subsection{Эйлеровость графов}

\begin{note}
	Далее, говоря о графах в этой теме, мы подразумеваем просто неориентированные графы.
\end{note}

\subsubsection*{История про Кёнигсбергские мосты}

Кёнигсберг (нем. Königsberg) - это нынешний Калининград. В 17м веке в этом городе было 7 мостов, расположенных следующим образом:

\textcolor{red}{Когда-нибудь тут будет картинка, ну а так смотрите либо на Википедии, либо в лекции Андрея Михайловича}

У людей был интересный вопрос: можно ли начать из какой-то точки города, пройти \underline{ровно 1 раз} по каждому мосту и вернуться в исходную точку. Задача была решена математиком Леонардом Эйлером в его статье от 1736г., где была доказана невозможность такого обхода и было создано понятие \textit{эйлерового графа}.

\begin{definition}
	Граф $G = (V, E)$ называется \textit{эйлеровым} (или же \textit{циклом}), если в нём существует цикл на всех рёбрах.
\end{definition}

\begin{theorem}
	Для связного псевдографа следующие 3 свойства эквивалентны:
	\begin{enumerate}
		\item Граф является циклом (эйлеровым графом).
		
		\item Степень каждой вершины чётна.
		
		\item Множество рёбер этого графа можно разбить на простые циклы (маршруты то есть), у которых могут быть общие вершины, но все рёбра разные.
	\end{enumerate}
\end{theorem}

\begin{proof}~
	\begin{itemize}
		\item $1 \Ra 2$ Очевидно, так как сколько раз мы вошли в какую-то вершину, столько же раз мы и вышли из неё, при этом ребро входа/выхода всегда было новым.
		\item $2 \Ra 1$ Проведём индукцию по $m$ - числу рёбер:
		\begin{itemize}
			\item База $m \le 1$: тривиально (граф с одним ребром является просто петлей)
			
			\item Переход $m > 1$:
			Выберем произвольную вершину $x$ и просто пойдём от неё куда-то по рёбрам, по которым мы ещё не ходили. Рассмотрим возможные ситуации с вершиной, в которую мы придём:
			\begin{enumerate}
				\item Из вершины есть путь. Тогда возможно ещё 2 варианта:
				\begin{enumerate}
					\item Мы не были в этой вершине. Просто идём дальше.
					
					\item Мы были в этой вершине, а значит получился простой цикл, у которого начало и конец на этой вершине.
				\end{enumerate}
			
				\item Из конечной вершины нет пути. Так как степень всех вершин чётна, то такое может быть только в случае, если мы попали обратно в вершину $x$. Следовательно, получили простой цикл с началом и концом в $x$.
			\end{enumerate}
			Обозначим найденный простой цикл за $C$, его начало за $y$, а множество рёбер цикла как $E_C$. Рассмотрим граф $G' = (V, E \bs E_C)$, полученный из исходного графа $G = (V, E)$. Понятно, что степень любой вершины из $G'$ тоже чётная, но граф $G'$ мог оказаться не связным, а состоять из нескольких компонент связности. Воспользуемся для каждой из них предположением индукции. Тогда пусть $v_i$ - это $i$-я вершина в обходе цикла $C$, а $\mu_i$ - это соответствующий ей эйлеров цикл в своей компоненте. Чтобы получить эйлеров цикл для $G$, достаточно обойти $C$ и, например, пройти по $\mu_i$ лишь тогда, когда $v_i$ - это последняя вершина, связанная с данной компонентой в обходе $C$.
		\end{itemize}
	
		\item $1 \Ra 3$ Посмотрим на эйлеров цикл $\mu$ исходного графа $G = (V, E)$. Возможно 2 ситуации:
		\begin{enumerate}
			\item В $\mu$ нету одинаковых промежуточных вершин. В таком случае эйлеров цикл - простой, и утверждение тривиально выполнено.
			
			\item В маршруте $\mu$ нашлась хотя бы пара одинаковых промежуточных вершин. Среди всех таких пар выберем самую левую и такую, что между парой нету третьей такой же вершины. Тогда цикл выглядит так:
			\[
				xAvBvCx
			\]
			где $A, B, C$ - сокращения для частей маршрута. При этом $vBv$ - простой цикл, а $xAvCx$ - обычный.
		\end{enumerate}
		Применим аналогичные рассуждения к $xAvCx$. Так как либо длина рассматриваемого маршрута уменьшается, либо он просто нам подходит, то мы обязательно разобьём его на простые циклы.
		
		\item $3 \Ra 2$ Заметим, что рёбра, инцидентные одной вершине, разбиваются на пары по принадлежности к какому-то из циклов. Отсюда сразу следует необходимое.
	\end{itemize}
\end{proof}

\subsection{Гамильтоновость графов}

\begin{definition}
	Граф $G = (V, E)$ называется \textit{гамильтоновым}, если существует простой путь, содержащий все его вершины. Такой путь называется тоже \textit{гамильтоновым}.
\end{definition}

\begin{definition}
	Если найдётся гамильтонов путь, который является ещё и циклом, то он называется \textit{гамильтоновым циклом}.
\end{definition}

\begin{theorem} (Дирака, не с лекций, но спрашивают на экзамене)
	Если у графа $G = (V, E), |V| = n$ степень каждой вершины $\ge \frac{n}{2}$, то он гамильтонов.
\end{theorem}

\begin{proof}
	Предположим, это не так. Тогда пусть $n > 2$ и $k > 0$ - минимальное количество вершин, которые нужно добавить в граф $G$ и соединить со всеми изначальными вершинами, чтобы он стал гамильтоновым. Пусть $G'$ - это граф $G$, дополненный этими вершинами. Рассмотрим гамильтонов цикл:
	\[
		v \mapsto p \mapsto w \mapsto \ldots \mapsto v
	\]
	Из-за необходимости дополнительных вершин, мы можем потребовать, что $p$ - одна из таких (ибо цикл покрывает все вершины, причём промежуточные по одному разу). При этом $w$ не может быть тогда новой вершиной в силу минимальности $k$. Заметим 2 факта:
	\begin{enumerate}
		\item Вершина $w$ не смежная к $v$, ибо иначе нам не нужна вершина $p$.
		
		\item Пусть $w',\ v'$ - вершины, смежные с $w,\ v$ соответственно. Тогда между $v'$ и $w'$ не может быть ребра, иначе можно обойтись без $p$ (не умаляя общности, рассмотрим такой порядок):
		\[
			v \mapsto p \mapsto w \mapsto \ldots \mapsto v' \mapsto \ldots \mapsto w' \mapsto \ldots \mapsto v
		\]
		можно заменить на следующий:
		\[
			v \mapsto v' \mapsto \ldots \mapsto w \mapsto w' \mapsto \ldots \mapsto v
		\]
		То есть избавились от $p$, чего быть не должно.
	\end{enumerate}
	Из вышесказанного следует, что множество смежных с $w$ вершин не пересекается с множеством смежных с $v$ вершин. Так как $\deg v,\ \deg w \ge n/2 + k$, то отсюда число вершин в $G'$ должно быть как минимум $n + 2k$, а на деле оно $n + k$. Противоречие.
\end{proof}

\begin{definition}
	Пусть дан граф $G = (V, E)$. Множество $W \subseteq V$ называется \textit{независимым}, если
	\[
		\forall x, y \in W\ (x, y) \notin E
	\]
\end{definition}

\begin{definition}
	Для графа $G = (V, E)$ величина $\alpha(G)$ называется \textit{числом независимости графа} и означает максимальную мощность независимого подмножества в $V$.
	\[
		\alpha(G) = \max \{k \in \N \such |W| = k\}
	\]
\end{definition}

\begin{example}
	Для графа-простого цикла на $n$ вершинах верно, что
	\[
		\alpha(G) = \floor{\frac{n}{2}}
	\]
\end{example}

\begin{definition}
	\textit{Подграфом} $G' = (W, E')$ графа $G = (V, E)$ называется граф, у которого $W \subseteq V$, а $E' \subseteq \{(x, y) \such x, y \in W, (x, y) \in E\}$.
\end{definition}

\begin{definition}
	Подграф $G' = (W, E')$ называется \textit{индуцированным}, если \\ $E' = \{(x, y) \such x, y \in W, (x, y) \in E\}$.
	
	Обозначение $G_{V \bs A}$ подразумевает индуцированный подграф, у которого $V' = V \bs A$.
\end{definition}

\begin{definition}
	Для графа $G = (V, E)$ величина $\kappa(G)$ называется \textit{числом вершинной связности} и описывается так:
	\[
		\kappa(G) = \min \{k \in \N \such \exists W \subseteq V, |W| = k \text{ и } G|_{V \bs W} \text{ не связен }\}
	\]
\end{definition}

\begin{note}
	$\kappa(G)$ означает минимальное число вершин, которое нужно удалить из графа $G$, чтобы он перестал быть связен. Для полного графа понятие обычно не применяют (или же как-то доопределяют).
\end{note}

\begin{theorem} (\'{Э}рдёш, Хв\'{а}тал)
	Если $\alpha(G) \le \kappa(G), |V| \ge 3$, то $G$ - гамильтонов граф.
\end{theorem}

\begin{proof}
	Сразу отметим, что $G$ связен. Если бы это было не так, то $\kappa(G) = 0$, но при этом $\alpha(G) > 0$ (пустой граф мы не рассматриваем).
	Проведём доказательство в несколько стадий:
	\begin{enumerate}
		\item Предположим, что в $G$ нет циклов. Тогда $G$ - дерево, причём в нём есть как минимум 2 листа, не соединённых друг с другом. Тогда очевидно, что $\alpha(G) \ge 2, \kappa(G) = 1$. Противоречие.
		
		\item Теперь в графе $G$ есть хотя бы один цикл. Рассмотрим самый длинный простой цикл $C = \{x_1, \ldots, x_k\}$. Предположим, что $k < n$, где $|V| = n$. Тогда, посмотрим на индуцированный подграф $G' := G_{V \bs C}$ и у него выберем $W$ - множество вершин любой связной компоненты $G'$. Обозначим за $N_W(G)$ - множество <<соседей>> вершин из $W$ в графе $G$:
		\[
			N_W(G) = \{y \in V \bs W \such \exists x \in W, (x, y) \in E(G)\}
		\]
		Заметим несколько утверждений про этот объект:
		\begin{enumerate}
			\item $N_W(G) \subseteq C$, так как рёбер из $W$ в $G'$ нет (мы выбрали $W$ как компоненту связности в графе $G'$).
			
			\item Если $x_i \in N_W(G)$, то $x_{i + 1} \notin N_W(G)$. Это понятно, так как иначе мы можем продлить цикл за счёт вершин из $W$. Значит, $N_W(G) \subset C$
			
			\item $\kappa(G) \le |N_W(G)|$. Действительно, при удалении $N_W(G)$ у нас возникает отдельная компонента $W$, но при этом от цикла что-то да останется, ибо по уже доказанному $N_W(G) \subset C$.
			
			\item Если положить за $M = \{x_{i + 1} \such x_i \in N_W(G)\}$, то $M \cap N_W(G) = \emptyset$ и $|M| = |N_W(G)|$. При этом $M$ оказывается независимым множеством. Доказательство последнего факта можно провести от противного: предположим, что $x_i, x_j \in N_W(G), i < j$, но при этом между $x_{i + 1}$ и $x_{j + 1}$ есть ребро. В таком случае, путь $x_i$ соединяется с $a \in W$, а $x_j$ с $b \in W$. Рассмотрим следующий цикл:
			\[
				x_1 \mapsto x_i \mapsto a \mapsto b \mapsto x_j \mapsto x_{i + 1} \mapsto x_{j + 1} \mapsto x_1
			\]
			Он простой, но при этом на 1 ребро длиннее $C$. Противоречие.
			
			\item $\forall x \in W\ M \cup \{x\}$ тоже независимое множество. В самом деле, $M \cap N_W(G) = \emptyset$, поэтому мы можем взять любую вершину из $W$ к себе.
		\end{enumerate}
	
		Отсюда имеем, что
		\[
			\alpha(G) \ge |M| + 1
		\]
		Но при этом
		\[
			\kappa(G) \le |N_W(G)| = |M|
		\]
		Противоречие с условием.
	\end{enumerate}
\end{proof}

\begin{note}
	Доказательство также даёт нам алгоритм для поиска гамильтонова пути - найдём какой-то простой цикл и будем его увеличивать при помощи рассуждений из теоремы, пока он не станет гамильтоновым циклом.
\end{note}

\begin{definition}
	Граф $G_n = (V_n, E_n),\ |V_n| = n$ называется \textit{разреженным}, если
	\[
		\liml_{n \to \infty} \frac{|V_n|}{|E_n|} = 0
	\]
\end{definition}

\begin{example}
	В некоторых случаях можно аккуратно посчитать число независимости графа при помощи математики. Рассмотрим один из них (и попробуем применить к нему теорему Дирака или Эрдёша-Хватала):
	
	Пусть дан граф $G = (V, E)$, где $V = \{A \subset \{1, \ldots, n\} \such |A| = 3\}$, а \\ $E = \{(A, B) \such |A \cap B| = 1\}$. Из определения понятно, что $|V| = C_n^3$. Более того, заметим, что наш граф - регулярный. Степень вершины $A$ можно посчитать так:
	
	Выберем одно из чисел $A$. Тогда, остаётся $n - 3$ числа, откуда нужно выбрать 2, и тогда мы получим вершину $B$, соединённую с $A$. То есть $\deg A = 3 \cdot C_{n - 3}^2$, а по лемме о рукопожатиях
	\[
		|E| = \frac{1}{2} \suml_{A \in V} \deg A = \frac{3 \cdot C_{n - 3}^2 \cdot C_n^3}{2} \sim \frac{3}{24}n^5
	\]
	Число вершин асимптотически ведёт себя как $n^3/6$, поэтому граф $G$ - разреженный. Значит, применить теорему Дирака не получится.
	
	Что из себя представляет любое независимое множество $W = \{A_1, \ldots, A_t\}$ этого графа?
	\[
		\forall i, j \in [1; t]\ |A_i \cap A_j| \in \{0, 2\}
	\]
	
	\begin{proposition}
		\[
			\alpha(G) = \System{
				&{n,\ n \equiv 0 \pmod 4}
				\\
				&{n - 1,\ n \equiv 1 \pmod 4}
				\\
				&{n - 2, \text{ иначе}}
			}
		\]
	\end{proposition}

	\begin{proof}
		Докажем оценку снизу. Разобьём множество $\{1, \ldots, n\}$ на множества по 4 элемента (за исключением, быть может, последнего): $\{1, 2, 3, 4\}, \{5, 6, 7, 8\}, \ldots$ В каждой такой четвёрке у нас есть $C_4^3 = 4$ вершины с соответствующим набором чисел. При этом пересекаться любые из этих 4 будут пересекаться по двум элементам, тогда как любые вершины из разных множеств не будут пересекаться вовсе. Отсюда и следует оценка.
		\textcolor{red}{Другая часть остаётся читателю в качестве домашнего задания (там просто по индукции надо).}
	\end{proof}

	Дополнительно покажем красивый способ доказать, что $\alpha(G) \le n$. Сопоставим $A_i \mapsto \vec{x}_i \in \{0, 1\}^n = \Z_2^n$ (координаты являются маской множества $\{1, \ldots, n\}$). Заметим следующий факт:
	\[
		|A_i \cap A_j| = (\vec{x}_i, \vec{x}_j)
	\]
	Если мы теперь докажем, что векторы, соответствующие независимому множеству $M$, образуют линейно независимую систему, то нужное неравенство автоматически доказано, ибо $\dim \Z_2^n = n$. Запишем линейную комбинацию векторов из $M$, которая оказалась равна нулю:
	\[
		c_1 \vec{x}_1 + \ldots + c_t \vec{x}_t = \vec{0}
	\]
	Что будет, если мы возьмём скалярное произведение с $\vec{x}_1$ от обеих частей равенства?
	\[
		c_1 (\vec{x}_1, \vec{x}_1) + \ldots + c_t (\vec{x}_t, \vec{x}_1) = (\vec{0}, \vec{x}_1) = 0
	\]
	Но при этом скалярное произведение для разных векторов либо 0, либо 2, что тоже равно 0 в $\Z_2$. Также $(\vec{x}_1, \vec{x}_1) = 3 \equiv 1$. Значит, $c_1 = 0$. Отсюда $\forall c_i = 0$, что и требовалось доказать.
	
	Теперь нужно как-то показать, что $\kappa(G) \ge n$, и тогда сможем применить теорему Эрдеша-Хватала. Рассмотрим следующий факт:
	\begin{proposition}
		Пусть есть произвольный граф $G = (V, E)$. Введём величину $f(x, y)$:
		\[
			f(x, y) := |\{u \in V \such (x, u), (y, u) \in E\}|
		\]
		В таком случае, оценка на $\kappa(G)$ снизу будет как минимум такой:
		\[
			\kappa(G) \ge \min\limits_{x, y} f(x, y)
		\]
	\end{proposition}

	\begin{note}
		То есть $f(x, y)$ - это число общих соседов у $x$ и $y$.
	\end{note}

	\begin{proof}
		Действительно, попробуем удалить меньше вершин, чем минимум $f(x, y)$. Тогда для любых двух вершин у нас останется сосед, который их соединяет.
	\end{proof}

	Теперь мы явно посчитаем $\min\limits_{x, y \in V} f(x, y)$ для нашего графа. Рассмотрим возможные случаи:
	\begin{itemize}
		\item $|x \cap y| = 0$, то есть тройки не пересекаются. Тогда мы должны выбрать по одному элементу из каждой тройки и взять ещё 1 среди тех, которые не встречаются в $x \cup y$. Отсюда
		\[
			f(x, y) = 3^2 \cdot (n - 6) = 9(n - 6)
		\]
		
		\item $|x \cap y| = 1$. Аналогичным образом получаем
		\[
			f(x, y) = C_{n - 5}^2 + 2^2 \cdot (n - 5)
		\]
		
		\item $|x \cap y| = 2$. Снова так же имеем
		\[
			f(x, y) = 2C_{n - 4}^2 + 1^2 \cdot (n - 4)
		\]
	\end{itemize}
	Из анализа величин выше несложно выяснить, что для достаточно большого $n$ первый случай будет минимальным. Очевидно, что $9(n - 6) \ge n$ для вполне большого $n$. Значит, граф будет гамильтоновым.
\end{example}