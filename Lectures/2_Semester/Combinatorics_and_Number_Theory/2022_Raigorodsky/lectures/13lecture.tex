\section{Начала теории графов}

\begin{definition}
	\textit{Графом} называется пара \textit{множества вершин} и \textit{множества рёбер}.
\end{definition}

\begin{definition}
	Граф $G = (V, E)$ называется \textit{обыкновенным (простым)}, если выполнены следующие условия:
	\begin{enumerate}
		\item Нет <<петель>>, то есть
		\[
			\forall x \in V\ \ \not\exists (x, x) \in E
		\]
		
		\item Нет ориентации, то есть
		\[
			\forall x, y \in V\ \ (x, y) = (y, x)
		\]
		
		\item Нет кратных рёбер, то есть
		\[
			E \subseteq C_V^2
		\]
	\end{enumerate}
\end{definition}

\begin{note}
	$C_V^2$ обозначает множество пар вершин из $V$ без повторений наборов в них.
\end{note}

\begin{anote}
	Во втором пункте я бы лучше сформулировал так:
	\[
		\forall x, y \in V\ \ (x, y) \in E \lra (y, x) \in E
	\]
\end{anote}

\begin{note}
	В дальнейшем, если мы говорим о графе без каких-либо оговорок, то подразумевается именно простой граф.
\end{note}

\textcolor{red}{Сюда бы картиночку с каким-то графом}

\begin{definition}
	Если мы отказываемся в определении обыкновенного графа от \textbf{первого} свойства, то он называется \textit{псевдографом}.
\end{definition}

\begin{definition}
	Если мы отказываемся в определении обыкновенного графа от \textbf{второго} свойства, то он называется \textit{орграфом (ориентированным графом)}.
\end{definition}

\begin{definition}
	Если мы отказываемся в определении обыкновенного графа от \textbf{третьего} свойства, то он называется \textit{мультиграфом} (не путать с гиперграфом!!!).
\end{definition}

\begin{note}
	Естественно, определения можно комбинировать.
\end{note}

\begin{definition}
	Граф $K_n = (V, E),\ |V| = n$ называется \textit{полным}, если у него есть все возможные рёбра. То есть $|E| = C_n^2$
\end{definition}

\begin{example}
	Сколько существует графов на $V = \{1, \ldots, n\}$ вершинах?
	
	У нас $C_n^2$ рёбер и каждое мы можем либо включить, либо не брать в наш граф. Отсюда их $2^{C_n^2}$ штук.
\end{example}

\begin{definition}
	Графы $G_1 = (V_1, E_1)$ и $G_2 = (V_2, E_2)$ называются \textit{изоморфными}, если существует биекция, удовлетворяющая следюущему условию:
	\[
		\phi \colon V_1 \to V_2 \such \forall e = (x, y)\ \ e \in E_1 \lra (\phi(x), \phi(y)) \in E_2
	\]
\end{definition}

\begin{definition}
	\textit{Степенью вершины} $v \in V$ называется количество рёбер, инцидентных ей. Обозначается как $\deg v$
\end{definition}

\begin{definition}
	\textit{Входящей степенью} $\indeg v$ называется число рёбер, инцидентных данной вершине, в которых $v$ стоит на \textbf{втором} месте:
	\[
		\indeg v = |\{y \such (y, v) \in E\}|
	\]
\end{definition}

\begin{definition}
	\textit{Исходящей степенью} $\outdeg v$ называется число рёбер, инцидентных данной вершине, в которых $v$ стоит на \textbf{первом} месте:
	\[
		\outdeg v = |\{y \such (v, y) \in E\}|
	\]
\end{definition}

\begin{note}
	Для простого графа $\forall v \in V\ \indeg v = \outdeg v$. Определения, данные выше, получают смысл для орграфов.
\end{note}

\begin{definition}
	Говорят, что в графе вершина $v \in V$ \textit{инцидентна} ребру $e \in E$ (или ребро $e$ инцидентно вершине $v$), если $e$ содержит в себе эту вершину.
\end{definition}

\begin{lemma} (О рукопожатиях)
	В графе любого типа $G = (V, E)$ верно утверждение:
	\[
		\suml_{v \in V} \deg v = 2|E|
	\]
\end{lemma}

\begin{proof}
	Давайте мысленно зафиксируемся на каком-то из рёбер, и начнём суммировать степени вершин. Наше ребро может быть учтено лишь тогда, когда мы будем считать вершины ему инцидентные, коих всего 2. Отсюда и получается равенство.
\end{proof}

\begin{definition}
	Граф называется \textit{регулярным}, если степени всех вершин одинаковы.
\end{definition}

\begin{definition}
	\textit{Маршрутом в графе} $G = (V, E)$ будем называть чередующуюся последовательность вершин и рёбер, которая начинается и заканчивается на вершинах.
	\[
		v_1 e_1 v_2 e_2 \ldots e_n v_{n + 1}, \quad \forall e_i\ \ e_i = (v_i, v_{i + 1})
	\]
\end{definition}

\begin{note}
	Определение маршрута, естественно, допускает возможность появления одинаковых рёбер и вершин в последовательности.
\end{note}

\begin{definition}
	Маршрут называется \textit{замкнутым}, если $v_1 = v_{n + 1}$
\end{definition}

\begin{definition}
	Если в замкнутом маршруте все рёбра разные, то он называется \textit{циклом}
\end{definition}

\begin{lemma}
	В замкнутом маршруте можно найти цикл. То есть из замкнутого маршрута получить корректный маршрут цикла.
\end{lemma}

\begin{proof}
	Пусть есть замкнутый маршрут. Возможно 2 ситуации:
	\begin{enumerate}
		\item Все рёбра замкнутого маршрута оказались разными. Тогда он будет циклом по определению.
		
		\item Нашлось хотя бы 2 одинаковых ребра. В силу конечности маршрута, мы можем рассмотреть такие 2 одинаковых ребра $e = (v, u)$, что между ними в маршруте стоят только разные рёбра. Возможно снова 2 ситуации:
		\begin{enumerate}
			\item В маршруте по ребру $e$ мы прошли с разных сторон.
			
			Если мы прошли $v \to u$, а потом $u \to v$, то мы нашли цикл, у которого начало и конец будут на вершине $u$. Как маршрут это бы означало следующее:
			\[
				veu \ldots uev \mapsto u \ldots u
			\]
			
			\item В маршруте по ребру $e$ мы прошли с одной и той же стороны.
			
			То есть вначале могло быть $u \to v$, но и потом вышло так же $u \to v$. Снова нашли цикл, который начинается и заканчивается в вершине $u$.
			\[
				uev \ldots uev \mapsto uev \ldots u
			\]
		\end{enumerate}
	\end{enumerate}
\end{proof}

\begin{definition}
	Цикл называется \textit{простым}, если помимо разных рёбер, у него все промежуточные вершины тоже разные (то есть кроме $v_1$ и $v_{n + 1}$).
\end{definition}

\begin{definition}
	Если маршрут не замкнут и все его рёбра разные, то он называется \textit{путём (или же цепью)}.
\end{definition}

\begin{definition}
	Путь называется \textit{простым}, если все его вершины разные.
\end{definition}

\begin{definition}
	Граф $G = (V, E)$ \textit{связен}, если для любой пары вершин $x, y \in V$ существует маршрут, начинающийся в $x$ и заканчивающийся в $y$.
\end{definition}

\begin{note}
	Есть между двумя вершинами в графе есть маршрут, то есть и простой путь. Действительно, давайте как-нибудь <<выкинем>> из маршрута части между двумя одинаковыми промежуточными вершинами так, чтобы больше одинаковых промежуточных вершин не осталось.
\end{note}

\begin{note}
	Отношение существования пути между вершинами является отношением эквивалентности на множестве $V$.
\end{note}

\begin{definition}
	Граф называется \textit{ациклическим}, если в нём не содержится циклов.
\end{definition}

\begin{definition}
	Граф $G = (V, E)$ называется \textit{деревом}, если он является связным ациклическим графом.
\end{definition}

\begin{theorem}
	Для графа $G = (V, E)$ следующие 4 утверждения эквивалентны:
	\begin{enumerate}
		\item $G$ - дерево
		
		\item В $G$ любые 2 вершины соединены единственной простой цепью
		
		\item $G$ связен и если $|V| = n$, то $|E| = n - 1$
		
		\item $G$ ацикличен и если $|V| = n$, то $|E| = n - 1$
	\end{enumerate}
\end{theorem}

\begin{proof}
	Построим цикл утверждений:
	\begin{itemize}
		\item $1 \Ra 2$ В силу определения дерева $G$, между двумя вершинами будет существовать простой путь. Если их как минимум 2, то на них можно найти цикл, что противоречит ацикличности дерева.
		
		\item $2 \Ra 3$ Связность очевидна. Для доказательства второго факта, воспользуемся индукцией по $n$:
		\begin{itemize}
			\item База $n = 1$ тривиальна.
			
			\item Переход $n > 1$.
			
			У всех вершин не может быть степень, равная $1$, ибо тогда отсутствует связность (граф имеет вид пар вершин, инцидентных своему ребру). При этом не может быть и степень, больше либо равная $2$: выберем произвольную вершину и будем просто идти по рёбрам, пока можем. В силу конечности графа мы обязательно придём в вершину, из которой либо нету ребра (то есть её степень равна 1, а такого быть не может), либо мы в ней оказались второй раз и нашли цикл (то есть какие-то 2 вершины соединены не единственным путём), противоречие.
			
			Теперь, доказав наличие вершины степени $1$ в нашем графе, выберем её и рассмотрим граф $G'$ без неё и инцидентного ей ребра. Тогда, к $G'$ применимо предположение индукции и $|V'| = n - 1, |E'| = n - 2$. Для графа $G$ это означает, что $|V| = |V'| + 1 = n, |E| = |E'| + 1 = n - 1$.
		\end{itemize}
	
		\item $3 \Ra 4$ Нужно проверить только ацикличность. Снова воспользуемся индукцией
		\begin{itemize}
			\item База $n = 1$ тривиальна
			
			\item Переход $n > 1$. Предположим, что это не так и есть цикл. Тогда у всех вершин цикла степень $\ge 2$. По лемме о рукопожатиях
			\[
				\suml_{v \in V} \deg v = 2|E| = 2n - 2
			\]
			Отсюда в частности следует, что $\exists v_0 \in V \colon \deg v_0 = 1$, так как если у всех вершин степень $\ge 2$, то сумма степеней $\ge 2n$, а если меньше или равна единице, то сумма $\le n$. Более того, из сказанного выше эта вершина не лежит на цикле. Значит, мы можем её и инцидентное ребро убрать из графа, применить предположение индукции и получить противоречие.
		\end{itemize}

		\item $4 \Ra 1$ Снова индукция по $n$ (проблема только со связностью).
	\end{itemize}
\end{proof}

\begin{example}
	Пусть $t_n$ - число деревьев на $n$ вершинах. Попробуем заметить некоторую закономерность
	\begin{align*}
		&{t_1 = 1}
		\\
		&{t_2 = 1 = 2^{2 - 2}}
		\\
		&{t_3 = 3 = 3^{3 - 2}}
		\\
		&{t_4 = 16 = 4^{4 - 2}}
		\\
		&{t_5 = 125 = 5^{5 - 2}}
		\\
		&{\vdots}
	\end{align*}
\end{example}

\begin{theorem} (Формула Кэли, 1857г.)
	\[
		t_n = n^{n - 2}
	\]
\end{theorem}

\begin{proof}
	Приведём идею с \textit{кодами Прюфера}: из формулы логично предположить, что мы можем каждому дереву на $n$ вершинах сопоставить размещение $n - 2$ чисел из множества $\{1, \ldots, n\}$ с повторениями. Покажем явно алгоритмы, один из которых будет по графу находить код, а другой по нему восстанавливать его.
	\begin{itemize}
		\item Алгоритм, который по графу возвращает код.
		\begin{enumerate}
			\item Выберем вершину степени 1 с наименьшим номером. Допишем справа в уже имеющийся код номер вершины, которая связана с нашей при помощи ребра.
			
			\item Удалим из графа выбранную вершину и инцидентное ей ребро.
			
			\item Повторим итерацию, пока не останется дерево на 2х вершинах.
		\end{enumerate}
		
		\item Алгоритм, который по коду возвращает граф.
		Выпишем последовательность $\{1, \ldots, n\}$, а под ней код, полученный из графа.
		\begin{enumerate}
			\item Выберем самое малое число из верхнего ряда, которого нет в нижнем.
			
			\item Сделаем пару-ребро $(u, v)$, где $u$ - выбранная на предыдущем этапе вершина, $v$ - первая вершина в нижнем ряде.
			
			\item Удалим найденные вершины из рядов.
			
			\item Повторим итерацию, пока не закончится нижний ряд. Сверху останется всего 2 вершины, и они тоже будут образовывать ребро.
		\end{enumerate}
	\end{itemize}

	Остаётся обосновать, что полученная функция сопоставления графу его кода - биекция.
	\begin{itemize}
		\item Инъективность
		
		\item Сюръективность
	\end{itemize}
\end{proof}

\begin{definition}
	\textit{Унициклическим графом (одноцикловым)} называется связный граф с ровно одним циклом.
\end{definition}

\begin{note}
	Из того, что в унициклическом графе всего 1 цикл следует, что этот цикл простой. Более того, унициклический граф на $n$ вершинах - это такой, в котором $|V| = |E| = n$.
\end{note}

\begin{example}
	Сколько существует унициклических графов на $n$ вершинах?
\end{example}

\begin{solution}
	Для начала разберёмся с тем, какие циклы у нас могут быть и сколько разных и может быть. Пусть $k$ - длина цикла по числу вершин. Тогда $k \in \{3, \ldots, n\}$, так как при $k = 2$ требуются кратные ребра, чем простой граф не обладает.
	
	Количество способов выбрать $k$ вершин для цикла - $C_n^k$, но сколькими их можно зациклить? Ответом будет $C_n^k \cdot k! / (2k)$, так как всего перестановок у нас $k!$, но нужно исключить циклические и зеркальные.
	
	Отсюда искомое количество $U_n$ можно записать так:
	\[
		U_n = \suml_{k = 3}^n C_n^k \frac{(k - 1)!}{2} \cdot F(n, k)
	\]
	где $F(n, k)$ - количество способов достроить цикл на $k$ вершинах до унициклического графа на $n$ вершинах. Иначе говоря, это число лесов на $n$ вершинах с $k$ деревьями, где выделенные $k$ вершин служат представтителями отдельных деревьев.
	
	\begin{theorem}
		$F(n, k) = k \cdot n^{n - 1 - k}$
	\end{theorem}

	\begin{proof}
		\textcolor{red}{Остаётся читателю в качестве домашнего задания. Будет на экзамене! Нужно расширить идею с кодами Прюфера}
	\end{proof}

	Итого, вся формула имеет следующий вид:
	\[
		U_n = \suml_{k = 3}^n C_n^k \frac{k!}{2} \cdot n^{n - 1 - k}
	\]
\end{solution}

\begin{corollary}
	В курсе дискретного анализа будет доказано, что
	\[
		U_n \sim \sqrt{\frac{\pi}{8}} \cdot n^{n - \frac{1}{2}}
	\]
\end{corollary}

\begin{note}
	Если положить за $C(n, n + k)$ - количество связных графов на $n$ вершинах и с $n + k$ рёбрами, то верно следующее:
	\begin{itemize}
		\item \[
			t_n = C(n, n - 1) = n^{n - 2}
		\]
		
		\item \[
			U_n = C(n, n) \sim \sqrt{\frac{\pi}{8}} n^{n - \frac{1}{2}}
		\]
		
		\item \[
			C(n, n + 1) \sim \frac{5}{24}n^{n + 1}
		\]
		
		\item \[
			C(n, n + k) \sim \gamma(k) \cdot n^{n + \frac{3k - 1}{2}}
		\]
	\end{itemize}
\end{note}