\begin{theorem} (Необходимое и достаточное условия строгой выпуклости)
	Пусть $f$ дважды дифференцируема на $(a; b)$. Тогда
	\begin{enumerate}
		\item $\forall x \in (a; b)\ f''(x) \ge 0 \lra$ $f$ выпукла вниз на $(a; b)$
		
		\item $\forall x \in (a; b)\ f''(x) \le 0 \lra$ $f$ выпукла вверх на $(a; b)$
		
		\item $\forall x \in (a; b)\ f''(x) > 0 \Ra$ $f$ строго выпукла вниз на $(a; b)$
		
		\item $\forall x \in (a; b)\ f''(x) < 0 \Ra$ $f$ строго выпукла вверх на $(a; b)$
	\end{enumerate}
\end{theorem}

\begin{proof}
	Докажем первый случай. Начнём с достаточности. Для этого распишем функцию в точках $x_1$ и $x_2$ по формуле Тейлора:
	\begin{align*}
		&f(x_1) = f(x_0) + f'(x_0)(x_1 - x_0) + \frac{f''(\xi_1)}{2!}(x_1 - x_0)^2,\ x_1 < \xi_1 < x_0
		\\
		&f(x_2) = f(x_0) + f'(x_0)(x_2 - x_0) + \frac{f''(\xi_2)}{2!}(x_2 - x_0)^2,\ x_0 < \xi_2 < x_2
	\end{align*}
	При этом естественно $a < x_1 < x_2 < b$. Так как вторая производная в точках $\xi_1$ и $\xi_2$ неотрицательна, то
	\begin{align*}
		f(x_1) \ge f(x_0) + f'(x_0)(x_1 - x_0)
		\\
		f(x_2) \ge f(x_0) + f'(x_0)(x_2 - x_0)
	\end{align*}
	Раз $x_0 \in (x_1; x_2)$, то $\exists t \in (0; 1) \such x_0 = tx_1 + (1 - t)x_2$. Домножим уравнения на $t > 0$ и $1 - t > 0$ соответственно и сложим. Получим
	\[
		t \cdot f(x_1) + (1 - t) \cdot f(x_2) \ge f(x_0) + f'(x_0)\left(tx_1 + (1 - t)x_2 - x_0\right) \ge f(x_0) = f(tx_1 + (1 - t)x_2)
	\]
	
	Теперь докажем необходимость. Выберем $\forall x_0 \in (a; b)$. Положим $\delta := \min(b - x_0, x_0 - a)$ и рассмотрим $\forall u \in (-\delta; \delta)$. Тогда $f(x_0 \pm u)$ - определены и могут быть записаны по Формуле Тейлора:
	\[
		f(x_0 \pm u) = f(x_0) \pm f'(x_0)u + \frac{f''(x_0)}{2!}u^2 + o(u^2),\ u \to 0
	\]
	Положим $x_1, x_2 \such x_1 < x_2, \{x_1, x_2\} = \{f(x_0 - u), f(x_0 + u)\}$. Тогда $t = \frac{1}{2}$ для $x_0$ при любом $u$. То есть
	\[
		f(x_0) \le \frac{1}{2}f(x_0 - u) + \frac{1}{2}f(x_0 + u)
	\]
	Подставим формулы Тейлора вместо $f(x_0 \pm u)$. Получим
	\[
		\frac{1}{2}\left(f(x_0 - u) + f(x_0 + u)\right) = f(x_0) + \frac{f''(x_0)}{2}u^2 + o(u^2),\ u \to 0
	\]
	Перепишем данное выражение в другом виде
	\[
		\frac{1}{u^2}\left(\frac{1}{2}\left(f(x_0 - u) + f(x_0 + u)\right) - f(x_0)\right) = \frac{f''(x_0)}{2} + o(1),\ u \to 0
	\]
	Раз правая часть имеет предел, то и левая тоже. При этом левая часть положительна. Значит
	\[
		\frac{f''(x_0)}{2} \ge 0 \lra f''(x_0) \ge 0
	\]
\end{proof}

\begin{note}
	В случаях 3 и 4 утверждение верно в одну сторону. Контрпример: 
	\[
		y = \pm x^4,\ x \in (-1; 1)
	\]
\end{note}

\begin{definition}
	Пусть $f$ непрерывна на $U_{\delta_0}(x_0)$, $\exists f'(x_0) \in \bar{\R}$ и $\exists \delta \in (0; \delta_0)$, при этом
	\begin{itemize}
		\item либо на $(x_0 - \delta; x_0)$ $f$ выпукла вниз, а на $(x_0; x_0 + \delta)$ выпукла вверх;
		
		\item либо на $(x_0 - \delta; x_0)$ $f$ выпукла вверх, а на $(x_0; x_0 + \delta)$ выпукла вниз.
	\end{itemize}
	Тогда $x_0$ называется \textit{точкой перегиба} $f(x)$.
\end{definition}

\begin{theorem} (Необходимое и достаточное условия точки перегиба)
	Если $f$ непрерывна в $U_{\delta_0}(x_0)$, $\exists f'(x_0) \in \bar{\R}$ и $f$ дважды дифференцируема в $\mc{U}_{\delta_0}(x_0)$, то $x_0$ является точкой перегиба функции $f(x)$ тогда и только тогда, когда $\exists \delta > 0$ такая, что
	\begin{itemize}
		\item либо $\forall x \in (x_0 - \delta; x_0)\ f''(x) \ge 0$ и $\forall x \in (x_0; x_0 + \delta)\ f''(x) \le 0$;
		
		\item либо $\forall x \in (x_0 - \delta; x_0)\ f''(x) \le 0$ и $\forall x \in (x_0; x_0 + \delta)\ f''(x) \ge 0$
	\end{itemize}
\end{theorem}

\begin{proof}
	Напрямую следует из необходимого и достаточного условий выпуклости функции.
\end{proof}

\begin{theorem} (Геометрическое необходимое условие точки перегиба) (\textbf{Будет переписано после консультации})
	Если $f$ дважды дифференцируема в окрестности точки $x_0$ и $y_{\text{кас}}(x) = f(x_0) + f'(x_0) (x - x_0)$ - уравнение касательной к графику $f(x)$ в точке $x_0$, то из выполнения одного из следующей пары условий следует, что $x_0$ - точка перегиба:
	\begin{enumerate}
		\item $\forall x \in (x_0 - \delta; x_0)\ y_{\text{кас}}(x) \le f(x)$ и $\forall x \in (x_0; x_0 + \delta)\ y_{\text{кас}}(x) \ge f(x)$;
		
		\item $\forall x \in (x_0 - \delta; x_0)\ y_{\text{кас}}(x) \ge f(x)$ и $\forall x \in (x_0; x_0 + \delta)\ y_{\text{кас}}(x) \le f(x)$.
	\end{enumerate}
\end{theorem}

\begin{proof}
	Распишем $f(x)$ по формуле Тейлора:
	\[
		f(x) = f(x_0) + f'(x_0)(x - x_0) + \frac{f''(\xi)}{2!}(x - x_0)^2 = y_{\text{кас}}(x) + \frac{f''(\xi)}{2!}(x - x_0)^2
	\]
	Доказательство свелось к смене знаков второй производной.
\end{proof}

\begin{note}
	Условия в теореме не являются достаточными. Контрпримером является функцияа
	\[
		f(x) = \System{
			&{\left(2 + \sin \frac{1}{x}\right)x^5,\ x \neq 0}
			\\
			&{0,\ x = 0}
		}
	\]
	Производная имеет вид
	\[
		f'(x) = \System{
			&{-x^3\cos \frac{1}{x} + 5x^4\left(2 + \sin \frac{1}{x}\right),\ x \neq 0}
			\\
			&{0,\ x = 0}
		}
	\]
	Вторая производная:
	\[
		f''(x) = \System{
			&{-x\sin \frac{1}{x} - 8x^2 \cos \frac{1}{x} + 20x^3 \left(2 + \sin \frac{1}{x}\right),\ x \neq 0}
			\\
			&{0,\ x = 0}
		}
	\]
	Рассмотрим значение второй производной при стремлении к нулю:
	\[
		f''(x) = -x\sin \frac{1}{x} - 8x^2 \cos \frac{1}{x} + 20x^3 \left(2 + \sin \frac{1}{x}\right) = -x \left(\sin \frac{1}{x} + 8x \cos \frac{1}{x} - 20x^2 \left(2 + \sin \frac{1}{x}\right)\right)
	\]
	То есть $f''$ бесконечно много раз меняет свой знак при стремлении к 0, хотя при этом выполнены условия на $y_{\text{кас}}$
\end{note}

%% Нарисовать. 58:03 запись стрима 19й лекции

\begin{definition}
	Прямая $x = x_0$ называется \textit{вертикальной асимптотой} графика функции $f(x)$, если хотя бы один из односторонних пределов $f(x_0 \pm 0)$ бесконечен.
\end{definition}

\begin{definition}
	Прямая $y = kx + b$ называется \textit{асимптотой} графика функции $f(x)$, если
	\[
		\liml_{x \to +\infty} (f(x) - (kx + b)) = 0
	\]
	или
	\[
		\liml_{x \to -\infty} (f(x) - (kx + b)) = 0
	\]
	Если $k = 0$, то асимптота называется \textit{горизонтальной}, при $k \neq 0$ - \textit{наклонной}.
\end{definition}

\begin{theorem}
	Прямая $y = kx + b$ является асимптотой графика функции $y = f(x)$ тогда и только тогда, когда существуют пределы
	\begin{align*}
		&\liml_{x \to +\infty} \frac{f(x)}{x} = k
		\\
		&\liml_{x \to +\infty} \left(f(x) - kx\right) = b
	\end{align*}
	Для $-\infty$ аналогично.
\end{theorem}

\begin{proof}
	Покажем необходимость: пусть $y = kx + b$ - асимптота. Значит
	\[
		\liml_{x \to +\infty} (f(x) - kx - b) = 0
	\]
	Заметим следующие пределы:
	\begin{align*}
		&\liml_{x \to +\infty} \frac{f(x) - kx - b}{x} = 0
		\\
		&\liml_{x \to +\infty} \frac{kx + b}{x} = k
	\end{align*}
	Отсюда следует, что
	\[
		\liml_{x \to +\infty} \frac{f(x) - kx - b}{x} = 0 = \liml_{x \to +\infty} \frac{f(x)}{x} - k \lra \liml_{x \to +\infty} \frac{f(x)}{x} = k
	\]
	А второй предел получается из самого первого простым добавлением $b$ в обе части:
	\[
		\liml_{x \to +\infty} \left(f(x) - kx - b\right) + b = b = \liml_{x \to +\infty} \left(f(x) - kx\right)
	\]
	
	Теперь покажем необходимость:
	\[
		\liml_{x \to +\infty} \left(f(x) - kx\right) = b \Ra \liml_{x \to +\infty} \left(f(x) - (kx + b)\right) = 0
	\]
\end{proof}

\subsubsection*{Схема исследования функции и построения графика}

\begin{enumerate}
	\item Область определения, особенности (чётность, нечётность, периодичность)
	
	\item Промежутки знакопостоянства, точки пересечения с осями координат
	
	\item Монотонность, экстремумы
	
	\item Выпуклость, точки перегиба
	
	\item Асимптоты
	
	\item Построение графика
\end{enumerate}

\begin{example}
	\[
		y = \sqrt{|x^2 - 3x + 2|}
	\]
	\begin{enumerate}
		\item $D(y) = \R$, функция общего вида, непериодична
		
		\item $y \ge 0$, точки пересечения с осями: $(0, \sqrt{2}),\ (1, 0),\ (2, 0)$
		
		\item При $x \neq 1,\ x \neq 2$:
		\[
			y' = \frac{(2x - 3) \cdot \sgn (x^2 - 3x + 2)}{2 \sqrt{|x^2 - 3x + 2|}}
		\]
		%%% Нарисовать
		Здесь должна быть числовая ось со знаками производной. Из рисунка следует, что
		\begin{align*}
			&{x = 1, \text{ - локальный минимум},\ y(1) = 0}
			\\
			&{x = \frac{3}{2}, \text{ - локальный максимум},\ y\left(\frac{3}{2}\right) = \frac{1}{2}}
			\\
			&{x = 2, \text{ - локальный минимум},\ y(2) = 0}
		\end{align*}
		\item При $x \neq 1,\ x \neq 2$
		\begin{multline*}
			y'' = \frac{1}{2} \cdot \frac{2 \sgn (x^2 - 3x + 2) \sqrt{|x^2 - 3x + 2|} - \frac{(2x - 3)^2 \sgn^2 (x^2 - 3x + 2)}{2 \sqrt{|x^2 - 3x + 2|}}}{|x^2 - 3x + 2|} =
			\\
			\frac{1}{4} \cdot \frac{4(x^2 - 3x + 2) - (2x - 3)^2}{|x^2 - 3x + 2|^{3/2}} = \frac{-1}{4|x^2 - 3x + 2|^{3/2}}
		\end{multline*}
		%%% Нарисовать
		Здесь должна быть числовая ось с направлениями выпуклости на интервалах.
		
		\item Сразу понятно, что у функции нету вертикальных асимптот. Найдём предел
		\[
			\liml_{x \to +\infty} \frac{y}{x} = \liml_{x \to +\infty} \sqrt{\frac{x^2 - 3x + 2}{x^2}} = 1
		\]
		Теперь ещё предел:
		\[
			\liml_{x \to +\infty} y - x = \liml_{x \to +\infty} \sqrt{x^2 - 3x + 2} - x = \liml_{x \to +\infty} \frac{x^2 - 3x + 2 - x^2}{\sqrt{x^2 - 3x + 2} + x} = -\frac{3}{2}
		\]
		То есть $y = x - \frac{3}{2}$ - правая наклонная асимптота.
		Аналогично проделаем для $x \to -\infty$:
		\[
			\liml_{x \to -\infty} \frac{y}{x} = -\liml_{x \to -\infty} \sqrt{\frac{x^2 - 3x + 2}{x^2}} = -1
		\]
		\[
			\liml_{x \to -\infty} \sqrt{x^2 - 3x + 2} - (-1)x = \liml_{x \to -\infty} \frac{x^2 - 3x + 2 - x^2}{\sqrt{x^2 - 3x + 2} - x} = \frac{3}{2}
		\]
		Отсюда $y = -x + \frac{3}{2}$ - левая наклонная асимптота.
		
		\item Тут должен быть график функции %%% Нарисовать 1:23:30 Введение в матан 19
	\end{enumerate}
\end{example}