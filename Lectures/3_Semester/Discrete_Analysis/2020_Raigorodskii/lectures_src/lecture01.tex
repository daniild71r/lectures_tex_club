\subsection{Оценки комбинаторных величин}

\subsubsection{Асимптотика биномиальных коэффициентов}

\begin{Def}
	Функции $f, g:N \rightarrow \mathbb{R}$ называются \emph{aсимптотически равными}, если \(\frac{f(n)}{g(n)} \rightarrow 1, n \rightarrow \infty \). Обозначение \(f(n) \sim g(n)\).
\end{Def}


\begin{example}
	В прошлом семестре из простых соображений бинома Ньютона была доказана оценка:
	\[ \frac{2^{2n}}{2n + 1} < C^n_{2n} < 2^{2n} \]
	
	Уже эта оценка позволяет нам получить асимптотику логарифма биномиального коэффициента:
	
	\[ 2n\ln(n) - \ln(2n+1) < \ln(C^n_{2n}) < 2n\ln(n) \]
	
	
	\[2 n \ln 2\left(1-\frac{\ln (2 n+1)}{2 n \ln 2}\right) < \ln C_{2 n}^{n} < 2n \ln 2, \]
	
	
	откуда \( \ln(C^n_{2n}) \sim 2n\ln(2) \).
	Из налогичных рассуждений следует оценка \(C^n_{2n} \sim \left(4 + o(1)\right)^n\).\footnote{Запись $f\left( n\right) = \left( g\left( n\right) + o\left( 1\right) \right) ^n $ эквивалентна $\sqrt[n]{f(n)} \sim g\left( n\right) $}
\end{example}

%\begin{note}
%	Пусть есть функция $f: \N \rightarrow \R$. Тогда запись $f\left( n\right) = \left( g\left( n\right) + o\left( 1\right) \right) ^n $ эквивалентна $\sqrt[n]{f(n)} \sim g\left( n\right) $.
%\end{note}

\begin{theorem}[Формула Стирлинга (б/д)]
	\[ n! \sim \sqrt{2\pi n} (\frac{n}{e})^n \]
\end{theorem}

\begin{note}
	Из \emph{Формулы Стирлинга} следует оценка для того же биномиального коэффициента: \(C^n_{2n} \sim \frac{4^n}{\sqrt{\pi n}}\).
\end{note}

\begin{theorem}
	Для $a \in \left( 0, 1\right)$ верно:
	\[C_{n}^{[a n]}=\left(a^{-a}(1-a)^{a-1}+o(1)\right)^{n} \]
	
\end{theorem}

\begin{proof}
	Распишем:
	
	%\begin{align*}
		%C_{n}^{[a n]}=\frac{n!}{[a n]!(n-[a n])!} &=
		%\frac{\sqrt{2 \pi n}\left(\frac{n}{e}\right)^{n}}{\sqrt{2 \pi[a n]}\left(\frac{[a n]}{e}\right)^{[a n]} \sqrt{2 \pi(n-[a n])}\left(\frac{(n-[a n])}{e}\right)^{(n-[a n])}} =
	%\end{align*}
	
	$$C_{n}^{[a n]}=\frac{n!}{[a n]!(n-[a n])!} =
	\frac{\sqrt{2 \pi n}\left(\frac{n}{e}\right)^{n}}{\sqrt{2 \pi[a n]}\left(\frac{[a n]}{e}\right)^{[a n]} \sqrt{2 \pi(n-[a n])}\left(\frac{(n-[a n])}{e}\right)^{n-[a n]}}= $$
	$$
	= \frac{\sqrt{2 \pi n}}{\sqrt{2 \pi[a n]} \sqrt{2 \pi\left( n-[a n]\right) }} \cdot \left( \frac{[an]}{n}\right) ^{-[an]}\left( \frac{n-[an]}{n}\right) ^{[an]-n}$$
	%=\left(\frac{1}{a^{a}(1-a)^{1-a}}\right)^{n} P(n),$$
	
	\qquad
	
	Тогда
	
	$$
	\sqrt[n]{C_{n}^{[a n]}}=\sqrt[n]{\frac{\sqrt{2 \pi n}}{\sqrt{2 \pi[a n]} \sqrt{2 \pi\left( n-[a n]\right) }}} \cdot \left( \frac{[an]}{n}\right) ^{-\frac{[an]}{n}}\left( \frac{n-[an]}{n}\right) ^{\frac{[an]-n}{n},}
	% \ln \left(\frac{1}{(a)^{a}(1-a)^{1-a}}\right) \sim n \ln \left(\frac{1}{(a)^{a}(1-a)^{1-a}}\right)
	$$
	
	При $n \to \infty$ первый множитель, очевидно, имеет пределом 1, а у второго и третьего и основания, и показатели степени имеют конечный предел. Из свойств экспонетны и логарифма заключаем треубемое. (Если говорить строго, то для экспоненциальной функции имеем $\lim_{x \to a} \exp(x) = \exp(a)$. Переходя к логарифму, для $a > 0$ имеем $\lim_{x \to a} \ln{x} = \ln(a)$. Тогда для $a > 0, b > 0$ имеем $\lim_{n \to \infty} f(n)^{g(n)} = \lim_{n \to \infty} \exp(\ln(f(n))g(n)) = \exp\left( \lim_{n \to \infty}(\ln(f(n))g(n))\right)  = \exp(\ln(\lim_{n \to \infty} f(n))\lim_{n \to \infty} g(n))$).
	
\end{proof}

\begin{theorem}
	Верны следующие оценки:
	\begin{enumerate}
		\item $C_{n}^{k} \leqslant \frac{n^{k}}{k !}$
		\item $C_{n}^{k} = \frac{n^{k}}{k!} \cdot e^{-\frac{k(k-1)}{2n} + O\left(\frac{k^3}{n^2}\right)}$
		\item Если $k = o(n^{\frac{2}{3}})$, то $C_{n}^{k} \sim \frac{n^{k}}{k!} \cdot e^{-\frac{k(k-1)}{2n}}$
		\item Если $k = o(\sqrt{n})$, то $C_{n}^{k} \sim \frac{n^{k}}{k!}$
	\end{enumerate}
	
\end{theorem} \label{exponent}

\begin{proof}
	\begin{enumerate}
		
		\item $C_{n}^{k}=\frac{n(n-1) \ldots(n-k+1)}{k !} \leqslant \frac{n^{k}}{k !} $
		\item Используя разложение функции $e^x$ в ряд Тейлора, получаем:
		
		\begin{eqnarray*}
		C_{n}^{k}=\frac{n(n-1) \ldots(n-k+1)}{k !}=\frac{n^{k}}{k!} \cdot e^{\:\ln \frac{n(n-1) \ldots(n-k+1)}{n^{k}}} \leqslant
		\frac{n^{k}}{k !} \cdot e^{\:ln(1 - \frac{1}{n}) + ln(\frac{2}{n})+\ldots+ln(\frac{k-1}{n})} = \\
		=\frac{n^{k}}{k!} \cdot e^{-\frac{1}{n} + O\left( \frac{1}{n^2}\right)  - \ldots  - \frac{k-1}{n} + O\left( \frac{( k-1)^2}{n^2}\right) } = \frac{n^{k}}{k!} \cdot e^{-\frac{k(k-1)}{2n} + O\left( \frac{k^3}{n^2}\right) }
		\end{eqnarray*}
		
	\end{enumerate}
\end{proof}

\begin{brainer}
	Найти асимптотику выражения:  $ \sum_{i = 0}^{n} \left( C_{n}^{i}\right)^\alpha $
\end{brainer}


\subsubsection{Графы}

\begin{Def}
	Графом называется пара множеств $(V, E)$, где $V$ -- множество каких-то
	объектов, а $E \subset \binom{V}{2}$ -- множество пар объектов из $V$.
\end{Def} 


\begin{Def}
	Маршрутом в графе $G=(V, E)$ называется последовательность $v_{1} e_{1} v_{2} \ldots e_{n} v_{n+1}$, где $e_i = \left\lbrace v_{n}, v_{i+1} \right\rbrace $.
	
	\begin{itemize}
		\item Если $v_{1}=v_{n+1}$, то маршрут называется \emph{замкнутым}.
		Если все $e_{i}$ в замкнутом маршруте различны, то он называется \emph{циклом}, а незамкнутый - \emph{путём}.
		\item Цепь (цикл) называется простой(-ым), если все $v_i$ в нем различны.
	\end{itemize}
\end{Def} 

\begin{Def}
	Граф называется \emph{связным}, если любые две его вершины соединены маршрутом.
\end{Def}

\begin{Def}
	\emph{Деревом} называется связный граф без циклов.
\end{Def}

\begin{Def}
	Вершина степени 1 в дереве называется \emph{листом} или \emph{висячей вершиной}.
\end{Def}

\begin{note}
	В каждом дереве на $n>1$ вершинах есть висячая вершина. (А на самом деле их хотя бы две!)
\end{note}

\begin{theorem} \label{equivalences}
	Следующие свойства графа эквивалентны:
	\begin{enumerate}
		\item Граф является деревом
		\item Граф, у которого любые две вершины соединены единственным маршрутом
		\item Связный граф, у которого число ребер на единицу меньше числа вершин
		\item Ациклический граф, у которого число ребер на единицу меньше числа вершин
	\end{enumerate}
\end{theorem}

\begin{proof}
	\;
	
	1 $\Rightarrow$ 2. 
	Докажем транспозицию.
	Если между двумя вершинами в графе $G$ нету пути, то он не является связным. Если путь между двумя вершинами не единственный, то, пройдя по первому, а затем по второму в обратном  направлении, мы получим цикл.
	
	2 $\Rightarrow $ 3.
	Очевидно, что $G$ связен. Докажем, что $|E|=|V| - 1$ по индукции по числу вершин. База $|V|=1$ очевидна. Предположим, что $|V|=n$, а утверждение верно для всех $k < n$. Удалим из
	графа $G$ некоторое ребро. Т.к. между любыми двумя вершинами существует ровно один простой путь, то $G$ распался на 2 компоненты связности. Применим предположение индукции для каждой из них и получим требуемое.
	
	3 $\Rightarrow $ 4.
	Предположим, что в графе, удовлетворяющем условию 3, есть цикл. Удалим в цикле прозвольное ребро. Граф остался связным, а количество ребер в нем стало равно $n-2$. Но тогда граф несвязный, поскольку в связном графе Будем повторять операцию, пока в графе не останется циклов. Тогда полученный граф будет удовлетворять условию 2, значит и условию 3. Но количество ребер в нем по предположению меньше $n - 1$. Следовательно, наше изначальное предположение было неверным, и граф ациклический.
	
	4 $\Rightarrow $ 1.
	Предположим противное. Будем действовать аналогично предыдущему пункту, удаляя по ребру в цикле на каждом шаге. Граф при этом остается связным. Когда граф станет ациклическим, он станет деревом, но с количеством вершин, меньшим, чем $|V| - 1$. Поскольку $1 \Rightarrow 4$, приходим к противоречию.
\end{proof}

\begin{theorem}[Кэли] \label{Caley}
	Количество деревьев на n занумерованных вершинах равно $n^{n - 2}$.
\end{theorem}

Приведем строгое доказательство теоремы.
\begin{proof}
	Для $n = 1$ утверждение теоремы тривиально.
	Условимся доказывать теорему для $n \geqslant 2$.
	\medskip
	
	Пусть дано дерево $T$ на $n$ вершинах. Возьмем копию дерева $T$ и будем применять следующий алгоритм, пока количество вершин в копии $n^{\prime} \geqslant 3$:
	\begin{enumerate}
		\item Выберем висячую вершину $v$ с минимальным номером. 
		\item Добавим в код Прюфера номер вершины, смежной с $v$.
		\item Удалим из дерева вершину $v$ и выходящее из нее ребро.
		\item Применим алгоритм к модифицированному графу на $n^{\prime} - 1$ вершинах.
	\end{enumerate}
	
	Докажем корректность алгоритма:
	\begin{enumerate} \renewcommand{\theenumi}{\bfseries \Roman{enumi}}
		\item Докажем, что на каждом шаге алгоритм определен. В начале алгоритма граф является деревом, следовательно, в нем есть висячая вершина, а значит и вершина с минимальным номером. Осталось показать, что после применения шага алогритма граф остается деревом. Действительно, при удалении висячей вершины граф остается связным, а цикла возникнуть не может.
		
		\item Докажем, что по завершении алгоритма мы получаем код из $n-2$ символа из элементов $\{1, \ldots, n\}$. Поскольку в начале алгоритма у графа $n$ вершин, а останавливается он при $n = 2$, то количество шагов алгоритма будет равно $n - 2$.
	\end{enumerate}
	
	
	Итак, мы определили соответсвие между $Tree(n)$ и $Prufer(n)$. Оно является отображением. Действительно, если одному дереву соответсвуют разные коды Прюфера, то возьмем первый символ, в котором они различны. Но на этом шаге мы записали в код номер вершины, смежной с висячей с наименьшим номером, которая, очевидно, одна.
	\medskip
	
	Рассмотрим полученное отображение $\varphi : Tree(n) \mapsto Prufer(n)$. Докажем по индукции, что $\varphi$ инъективно:
	
	База $|V| = 2$ очевидна. Предположим, что два различных дерева $T_{1}, T_{2}$ отвечают одному коду $v_{1} \ldots v_{n}, v_{i} \in\{1, \ldots, n\}$.
	Возможны следующие случаи:
	
	\begin{enumerate}
		\item Листы с наименьшим номером в $T_{1}$ и $T_{2}$ различны.
		ННО $k$ - наименьший номер висячей вершины  в $T_1$. Тогда первый код для $T_1$ номер этой вершины не войдет, а в код для $T_2$ - войдет, поскольку она не является висячей в $T_2$. Следовательно, у двух деревьев разные коды Прюфера.
		\item Листы с наименьшим номером совпадают, но различны их соседи. Тогда их коды отличаются уже в первом символе.
		\item Если же совпадают листы с наименьшими номерами и их соседи, то первый символ кодов Прюфера $T_1$ и $T_2$ совпадают, но после вычеркивания остаются два дерева, коды которых различны по предположению
		индукции.
	\end{enumerate}
	
	Докажем теперь, что отображение сюръективно или, что то же самое, предъявим алгоритм восстановления дерева по коду Прюфера.
	Вначале мы имеем последователньость $ \tau = v_{1} \ldots v_{n-2}, v_{i} \in\{1, \ldots, n\}$. размера $n-2$ и множество всех вершин графа: $ V = \left\lbrace 1… n\right\rbrace $. Применим следующюю процедуру:
	
	\begin{enumerate} 
		\item Берем первый элемент кода Прюфера $\tau$, и в множестве $V$ ищем вершину с наименьшим номером, которая не содержится в коде. Найденная вершина и текущий элемент массива с кодом Прюфера составляют ребро дерева. Запишем пару элементов в множество вершин будущего графа $E$.
		\item Удалим номер вершины из множества $V$ и первый элемент коде Прюфера.
		\item Применим алгоритм к модифицированному коду $\tau^{\prime}$ и множеству $V'$.
	\end{enumerate}
	
	В конце работы алгоритма в $V'$ останется две вершины, они составляют последнее ребро дерева.
	
	Докажем, что на выходе из алгоритма мы получаем граф $G = (V, E)$, являющийся деревом.
	
	У полученного графа $n-1$ вершина. Докажем, что он ациклический, откуда получим по теореме \ref{equivalences}, что граф является деревом.
	
	Предположим противное, т.\:е. в графе есть цикл $Z$. Возьмем первое ребро цикла $Z$, полученное по нашему алгоритму. Пусть это ребро $\left(v_i, v_j \right)$. Рассмотри шаг алгорима, на котором оно было получено.
	Н.Н.О. вершина $v_i$ была взята из множества $V'$. Но тогда на последующих шагах алгоритма не было построено ребер с $v_i$. Действительно, по построению $v_i$ нету ни в оставшейся части кода Прюфера, ни в множестве $V'\setminus{\left\lbrace v_i\right\rbrace }$. Поскольку мы взяли первое ребро в цикле, встретившееся в ходе алгоритма, то ребро с вершиной $v_i$, участвующее в цикле, не могло встретиться и до рассмотренного шага. Противоречие, т.\:е. цикла получиться не могло.
	
	Следовательно, отображение $\varphi$ является биекцией, что завершает доказательство теоремы.
\end{proof}

\bigskip

В качестве бонуса докажем следующее утверждение:

\begin{prop}
Вершина $v_i$ встречается в коде Прюфера $deg(v_i) - 1$ раз.
\end{prop}

\begin{proof}
Докажем, что если в коде Прюфера число $i$ встречается $k$ раз, то в соответствующем ему графе степень $deg(v_i) = k + 1$. Заметим, что в начале на доске выписано $n-2 + n = 2n - 2$ чисел. Выписанные числа - это числа кода Прюфера, а также элементы множества $\left\lbrace 1… n\right\rbrace$, поэтому число $i$ встречается среди выписанных $k+1$ раз. Поскольку по алгоритму код отображается в дерево, среди выписанных ребер нет петель и кратных ребер. Отсюда, результатом алгоритма является разбиение выписанных чисел на пары, т.\:е. $n - 1$ элемент множества $\left(\begin{array}{c} V \\ 2\end{array}\right)$. Отсюда, среди $n-1$ пары ровно $k+1$ тех, в которой участвует вершина $v_i$. 
\end{proof}
